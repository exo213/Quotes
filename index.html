<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zen Quote</title>
  <meta name="description" content="A minimalist quote of the day, refreshed every 3 hours." />

  <!-- Variable Serif Font: Playfair Display -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet" />

  <style>
    :root {
      --cloud-dancer: #F0F0E9;
      --glass-bg: rgba(255, 255, 255, 0.25);
      --glass-border: rgba(255, 255, 255, 0.4);
      --text-dark: #3a3a3a;
      --text-muted: #6b6b6b;
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      height: 100%;
      font-family: 'Playfair Display', Georgia, serif;
      background: var(--cloud-dancer);
      color: var(--text-dark);
    }

    /* Multi-tonal Gradient Animation */
    body {
      background: linear-gradient(
        135deg,
        #F0F0E9 0%,
        #E8E4DA 25%,
        #D9E4DD 50%,
        #E4E0D5 75%,
        #F0F0E9 100%
      );
      background-size: 400% 400%;
      animation: gradientShift 30s ease infinite;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Main Container */
    .container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }

    /* Glassmorphism Quote Card */
    .quote-card {
      max-width: 700px;
      width: 100%;
      padding: 3rem 2.5rem;
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid var(--glass-border);
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
      text-align: center;
    }

    /* Quote Text */
    .quote-text {
      font-size: clamp(1.4rem, 4vw, 2rem);
      font-weight: 500;
      line-height: 1.6;
      font-style: italic;
      margin-bottom: 1.5rem;
      opacity: 0;
      animation: fadeInQuote 2s ease forwards;
    }

    @keyframes fadeInQuote {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Author */
    .quote-author {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-muted);
      opacity: 0;
      animation: fadeInQuote 2s ease 0.5s forwards;
    }

    /* Footer Attribution */
    footer {
      position: fixed;
      bottom: 1rem;
      left: 0;
      right: 0;
      text-align: center;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    footer a {
      color: var(--text-muted);
      text-decoration: underline;
      transition: color 0.3s ease;
    }

    footer a:hover {
      color: var(--text-dark);
    }
  </style>
</head>
<body>
  <main class="container">
    <article class="quote-card" id="quoteCard">
      <p class="quote-text" id="quoteText">Loading...</p>
      <p class="quote-author" id="quoteAuthor"></p>
    </article>
  </main>

  <footer>
    Quotes provided by <a href="https://zenquotes.io/" target="_blank" rel="noopener noreferrer">ZenQuotes API</a>
  </footer>

  <script>
    (function () {
      const CACHE_KEY = 'zenQuoteCache';
      const THREE_HOURS_MS = 3 * 60 * 60 * 1000; // 10,800,000 ms
      const API_URL = 'https://api.allorigins.win/get?url=' + encodeURIComponent('https://zenquotes.io/api/random');

      const quoteTextEl = document.getElementById('quoteText');
      const quoteAuthorEl = document.getElementById('quoteAuthor');

      function displayQuote(text, author) {
        // Reset animations by cloning elements
        const newText = quoteTextEl.cloneNode(true);
        const newAuthor = quoteAuthorEl.cloneNode(true);
        newText.textContent = `"${text}"`;
        newAuthor.textContent = `â€” ${author}`;
        quoteTextEl.parentNode.replaceChild(newText, quoteTextEl);
        quoteAuthorEl.parentNode.replaceChild(newAuthor, quoteAuthorEl);
      }

      async function fetchNewQuote() {
        try {
          const response = await fetch(API_URL);
          if (!response.ok) throw new Error('Network response was not ok');
          const data = await response.json();
          const parsed = JSON.parse(data.contents);
          const quote = parsed[0];
          const cacheData = {
            text: quote.q,
            author: quote.a,
            timestamp: Date.now()
          };
          localStorage.setItem(CACHE_KEY, JSON.stringify(cacheData));
          displayQuote(cacheData.text, cacheData.author);
        } catch (error) {
          console.error('Error fetching quote:', error);
          quoteTextEl.textContent = 'Could not load quote. Please try again later.';
        }
      }

      function init() {
        const cached = localStorage.getItem(CACHE_KEY);
        if (cached) {
          try {
            const { text, author, timestamp } = JSON.parse(cached);
            const age = Date.now() - timestamp;
            if (age < THREE_HOURS_MS) {
              displayQuote(text, author);
              return;
            }
          } catch (e) {
            console.warn('Cache parse error, fetching new quote.');
          }
        }
        fetchNewQuote();
      }

      init();
    })();
  </script>
</body>
</html>
